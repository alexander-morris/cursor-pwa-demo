{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport { GoogleAuthProvider, signInWithPopup, signInWithRedirect, getRedirectResult } from 'firebase/auth';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth } from 'firebase/auth';\nimport { getFirestore, enableIndexedDbPersistence } from 'firebase/firestore';\nimport env from \"../config/environment\";\nvar firebaseConfig = env.firebase;\nconsole.log('Initializing Firebase with config:', _objectSpread(_objectSpread({}, firebaseConfig), {}, {\n  apiKey: firebaseConfig.apiKey.substring(0, 8) + '...'\n}));\nvar app = initializeApp(firebaseConfig);\nvar auth = getAuth(app);\nvar db = getFirestore(app);\ntry {\n  enableIndexedDbPersistence(db).catch(function (err) {\n    if (err.code === 'failed-precondition') {\n      console.warn('Multiple tabs open, persistence can only be enabled in one tab at a time.');\n    } else if (err.code === 'unimplemented') {\n      console.warn('The current browser does not support persistence.');\n    }\n  });\n} catch (error) {\n  console.error('Error enabling persistence:', error);\n}\nconsole.log('Firebase initialized:', {\n  auth: !!auth,\n  db: !!db\n});\nexport var signInWithGoogle = function () {\n  var _ref = _asyncToGenerator(function* () {\n    try {\n      var _provider = new GoogleAuthProvider();\n      _provider.setCustomParameters({\n        prompt: 'select_account',\n        redirect_uri: window.location.origin,\n        auth_type: 'popup'\n      });\n      auth.useDeviceLanguage();\n      var result = yield signInWithPopup(auth, _provider);\n      return {\n        name: result.user.displayName,\n        email: result.user.email,\n        uid: result.user.uid\n      };\n    } catch (error) {\n      console.error('Google sign in error:', error);\n      if (error.code === 'auth/configuration-not-found') {\n        throw new Error('Google Sign In is not properly configured. Please try again later.');\n      } else if (error.code === 'auth/popup-blocked') {\n        try {\n          yield signInWithRedirect(auth, provider);\n          return null;\n        } catch (redirectError) {\n          throw new Error('Please allow popups for this website or try again later.');\n        }\n      } else {\n        throw new Error('Failed to sign in with Google. Please try again.');\n      }\n    }\n  });\n  return function signInWithGoogle() {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var handleRedirectResult = function () {\n  var _ref2 = _asyncToGenerator(function* () {\n    try {\n      var result = yield getRedirectResult(auth);\n      if (result) {\n        return {\n          name: result.user.displayName,\n          email: result.user.email,\n          uid: result.user.uid\n        };\n      }\n      return null;\n    } catch (error) {\n      console.error('Redirect result error:', error);\n      return null;\n    }\n  });\n  return function handleRedirectResult() {\n    return _ref2.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["GoogleAuthProvider","signInWithPopup","signInWithRedirect","getRedirectResult","initializeApp","getAuth","getFirestore","enableIndexedDbPersistence","env","firebaseConfig","firebase","console","log","_objectSpread","apiKey","substring","app","auth","db","catch","err","code","warn","error","signInWithGoogle","_ref","_asyncToGenerator","provider","setCustomParameters","prompt","redirect_uri","window","location","origin","auth_type","useDeviceLanguage","result","name","user","displayName","email","uid","Error","redirectError","apply","arguments","handleRedirectResult","_ref2"],"sources":["/Users/almorris/cursor-test/frontend/src/services/auth.js"],"sourcesContent":["import { GoogleAuthProvider, signInWithPopup, signInWithRedirect, getRedirectResult } from 'firebase/auth';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth } from 'firebase/auth';\nimport { getFirestore, enableIndexedDbPersistence } from 'firebase/firestore';\nimport env from '../config/environment';\n\nconst firebaseConfig = env.firebase;\n\nconsole.log('Initializing Firebase with config:', {\n  ...firebaseConfig,\n  apiKey: firebaseConfig.apiKey.substring(0, 8) + '...' // Log partial API key for security\n});\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getFirestore(app);\n\n// Enable offline persistence\ntry {\n  enableIndexedDbPersistence(db).catch((err) => {\n    if (err.code === 'failed-precondition') {\n      console.warn('Multiple tabs open, persistence can only be enabled in one tab at a time.');\n    } else if (err.code === 'unimplemented') {\n      console.warn('The current browser does not support persistence.');\n    }\n  });\n} catch (error) {\n  console.error('Error enabling persistence:', error);\n}\n\n// Verify initialization\nconsole.log('Firebase initialized:', {\n  auth: !!auth,\n  db: !!db\n});\n\nexport const signInWithGoogle = async () => {\n  try {\n    const provider = new GoogleAuthProvider();\n    provider.setCustomParameters({\n      prompt: 'select_account',\n      redirect_uri: window.location.origin,\n      auth_type: 'popup'\n    });\n\n    // Configure auth instance\n    auth.useDeviceLanguage();\n\n    const result = await signInWithPopup(auth, provider);\n    return {\n      name: result.user.displayName,\n      email: result.user.email,\n      uid: result.user.uid\n    };\n  } catch (error) {\n    console.error('Google sign in error:', error);\n    if (error.code === 'auth/configuration-not-found') {\n      throw new Error('Google Sign In is not properly configured. Please try again later.');\n    } else if (error.code === 'auth/popup-blocked') {\n      // Try redirect method if popup is blocked\n      try {\n        await signInWithRedirect(auth, provider);\n        return null; // User will be redirected\n      } catch (redirectError) {\n        throw new Error('Please allow popups for this website or try again later.');\n      }\n    } else {\n      throw new Error('Failed to sign in with Google. Please try again.');\n    }\n  }\n};\n\n// Add handler for redirect result\nexport const handleRedirectResult = async () => {\n  try {\n    const result = await getRedirectResult(auth);\n    if (result) {\n      return {\n        name: result.user.displayName,\n        email: result.user.email,\n        uid: result.user.uid\n      };\n    }\n    return null;\n  } catch (error) {\n    console.error('Redirect result error:', error);\n    return null;\n  }\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}